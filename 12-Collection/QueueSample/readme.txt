producer-consumer pattern using queue .